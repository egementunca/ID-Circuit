# ID-Circuit: Identity Circuit Factory

A comprehensive system for generating, analyzing, and managing quantum identity circuits using SAT-based synthesis and advanced unrolling techniques.

## Overview

ID-Circuit is a sophisticated quantum circuit generation and analysis platform that leverages the `sat_revsynth` library to create identity circuits and explore their equivalent representations. The system provides a REST API for circuit generation, unrolling, and analysis, along with a modern web interface for visualization and interaction.

## Features

-   **SAT-Based Circuit Generation**: Generate identity circuits using advanced SAT synthesis
-   **Circuit Unrolling**: Explore equivalent circuit representations using various transformation methods
-   **Representative Management**: Intelligent grouping of equivalent circuits with representative selection
-   **Debris Cancellation Analysis**: Analyze circuits for potential simplification opportunities
-   **ML Feature Extraction**: Extract complexity metrics and optimization suggestions
-   **REST API**: Full-featured API for programmatic access
-   **Web Interface**: Modern, responsive UI for circuit visualization and management
-   **Database Persistence**: SQLite-based storage with efficient indexing and relationships

## Architecture

### Core Components

1. **Factory Manager** (`identity_factory/factory_manager.py`): Main orchestrator for circuit generation and processing
2. **Seed Generator** (`identity_factory/seed_generator.py`): SAT-based identity circuit generation
3. **Circuit Unroller** (`identity_factory/unroller.py`): Equivalent circuit generation using sat_revsynth
4. **Database Layer** (`identity_factory/database.py`): SQLite-based persistence with relationship management
5. **API Server** (`identity_factory/api/`): FastAPI-based REST API
6. **Web Interface** (`frontend.html`): Modern JavaScript-based UI

### Data Model

-   **Dimension Groups**: Collections of circuits with same (width, gate_count)
-   **Representatives**: Selected circuits representing unique gate compositions
-   **Equivalents**: Circuits generated by unrolling representatives
-   **Circuit Records**: Individual circuit data with gates, metadata, and relationships

## Quick Start

### Prerequisites

-   Python 3.8+
-   SQLite3
-   Required Python packages (see `requirements.txt`)

### Installation

1. **Clone the repository**:

    ```bash
    git clone <repository-url>
    cd ID-Circuit
    ```

2. **Install dependencies**:

    ```bash
    pip install -r requirements.txt
    ```

3. **Initialize the database**:

    ```bash
    python -m identity_factory
    ```

4. **Start the API server**:

    ```bash
    python start_api.py
    ```

5. **Access the web interface**:
   Open `http://localhost:8000` in your browser

### Basic Usage

#### Generate a Circuit

```python
import requests

# Generate a 3-qubit circuit with 4 gates
response = requests.post("http://localhost:8000/api/v1/generate", json={
    "width": 3,
    "gate_count": 4
})

circuit_data = response.json()
print(f"Generated circuit ID: {circuit_data['circuit_id']}")
```

#### Unroll a Circuit

```python
# Unroll a circuit to find equivalents
response = requests.post(f"http://localhost:8000/api/v1/circuits/{circuit_id}/unroll")
unroll_result = response.json()
print(f"Generated {unroll_result['equivalents_generated']} equivalents")
```

#### Get Circuit Analysis

```python
# Get circuit ASCII representation
response = requests.get(f"http://localhost:8000/api/v1/circuits/{circuit_id}/ascii")
ascii_data = response.json()
print(ascii_data['ascii_diagram'])
```

## API Reference

### Core Endpoints

-   `POST /api/v1/generate` - Generate new identity circuits
-   `GET /api/v1/dim-groups` - List dimension groups
-   `GET /api/v1/dim-groups/{id}/representatives` - Get representatives for a dimension group
-   `POST /api/v1/circuits/{id}/unroll` - Unroll a circuit to find equivalents
-   `GET /api/v1/circuits/{id}/equivalents` - Get equivalents for a circuit
-   `GET /api/v1/circuits/{id}/ascii` - Get ASCII representation of a circuit
-   `POST /api/v1/dim-groups/{id}/unroll-all` - Unroll all representatives in a dimension group

### Response Models

All API responses follow consistent patterns with success/error indicators and detailed metadata. See `identity_factory/api/models.py` for complete response schemas.

## Configuration

The system can be configured through environment variables or by modifying the `FactoryConfig` class in `factory_manager.py`:

-   `max_equivalents`: Maximum equivalents to generate per circuit (default: 10000)
-   `max_inverse_gates`: Maximum gates in inverse circuits (default: 40)
-   `enable_post_processing`: Enable circuit simplification (default: True)
-   `enable_debris_analysis`: Enable debris cancellation analysis (default: True)

## Database Schema

The system uses SQLite with the following main tables:

-   `circuits`: Individual circuit data with gates and metadata
-   `dim_groups`: Dimension group definitions
-   `representatives`: Representative circuit mappings
-   `equivalents`: Equivalent circuit relationships
-   `dim_group_circuits`: Many-to-many relationship between circuits and dimension groups

## Known Issues and Limitations

### ✅ Recently Fixed Issues

1. **✅ FIXED - Data Corruption in Unrolling**: The circuit unrolling feature previously encountered data corruption. This has been **completely resolved** with proper type checking and validation in the unroll processing pipeline.

2. **✅ FIXED - Dimension Group Consistency**: Circuits are now properly assigned to correct dimension groups with automated validation and correction.

3. **✅ FIXED - Circuit Pattern Diversity**: Enhanced the seed generator to produce more diverse circuit patterns including alternating NOT sequences and varied CNOT combinations.

### Current Considerations

1. **Memory Usage**: Large-scale unrolling operations can consume significant memory. Consider limiting `max_equivalents` for production use.

2. **SAT Solver Dependencies**: The system requires the `sat_revsynth` library and its dependencies. Some SAT solvers may need to be installed separately.

### Performance Considerations

-   Circuit generation time scales with circuit complexity
-   Unrolling operations can be computationally expensive
-   Database queries are optimized but may slow with large datasets
-   Consider using the job queue for background processing of large operations

## Development

### Project Structure

```
ID-Circuit/
├── identity_factory/          # Main application package
│   ├── api/                  # REST API implementation
│   ├── database.py           # Database layer
│   ├── factory_manager.py    # Main orchestrator
│   ├── seed_generator.py     # Circuit generation
│   ├── unroller.py          # Circuit unrolling
│   └── ...
├── sat_revsynth/            # SAT-based synthesis library
├── frontend.html            # Web interface
├── start_api.py            # API server launcher
└── requirements.txt        # Python dependencies
```

### Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Add tests for new functionality
5. Submit a pull request

### Testing

Run the test suite:

```bash
python -m pytest tests/
```

## License

[Add your license information here]

## Acknowledgments

-   Built on the `sat_revsynth` library for SAT-based circuit synthesis
-   Uses FastAPI for the REST API framework
-   Leverages SQLite for efficient data persistence

## Support

For issues, questions, or contributions, please:

1. Check the known issues section above
2. Review the API documentation
3. Open an issue on the project repository
4. Contact the development team

---

**Note**: This system is designed for research and educational purposes. Production use should include additional testing and validation.
